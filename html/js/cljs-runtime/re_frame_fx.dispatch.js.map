{"version":3,"sources":["re_frame_fx/dispatch.cljs"],"mappings":"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","names":["re-frame-fx.dispatch/deferred-actions","cljs.core.atom","re-frame-fx.dispatch/dispatch-debounce","dispatch-map-or-seq","cancel-timeout","id","temp__5753__auto__","deferred","cljs.core/deref","cljs.core.get","js/clearTimeout","cljs.core.swap_BANG_","cljs.core/dissoc","run-action","action","event","cljs.core._EQ_","re-frame.core/dispatch","seq__38018","cljs.core/seq","chunk__38019","count__38020","i__38021","cljs.core/chunked-seq?","c__4638__auto__","cljs.core/chunk-first","cljs.core/chunk-rest","cljs.core/count","cljs.core/first","cljs.core/next","e","seq__38027","chunk__38028","count__38029","i__38030","map__38046","cljs.core/--destructure-map","map__38061","timeout","G__38044","cljs.core/PersistentVector","cljs.core/sequential?","fexpr__38050","fexpr__38064","cljs.core/assoc","js/setTimeout","map__38054","map__38076","js/Error","re-frame.core/reg-fx"],"sourcesContent":[";;   Copyright (c) 7theta. All rights reserved.\n;;   The use and distribution terms for this software are covered by the\n;;   Eclipse Public License 1.0 (http://www.eclipse.org/legal/epl-v10.html)\n;;   which can be found in the LICENSE file at the root of this\n;;   distribution.\n;;\n;;   By using this software in any fashion, you are agreeing to be bound by\n;;   the terms of this license.\n;;   You must not remove this notice, or any others, from this software.\n\n(ns re-frame-fx.dispatch\n  (:require [re-frame.core :refer [reg-fx dispatch]]))\n\n(def ^:private deferred-actions (atom {}))\n\n(defn dispatch-debounce\n  [dispatch-map-or-seq]\n  (let [cancel-timeout (fn [id]\n                         (when-let [deferred (get @deferred-actions id)]\n                           (js/clearTimeout (:timer deferred))\n                           (swap! deferred-actions dissoc id)))\n        run-action (fn [action event]\n                     (cond\n                       (= :dispatch action) (dispatch event)\n                       (= :dispatch-n action) (doseq [e event]\n                                                (dispatch e))))]\n    (doseq [{:keys [id timeout action event]}\n            (cond-> dispatch-map-or-seq\n              (not (sequential? dispatch-map-or-seq)) vector)]\n      (cond\n        (#{:dispatch :dispatch-n} action)\n        (do (cancel-timeout id)\n            (swap! deferred-actions assoc id\n                   {:action action\n                    :event event\n                    :timer (js/setTimeout (fn []\n                                            (cancel-timeout id)\n                                            (run-action action event))\n                                          timeout)}))\n\n        (= :cancel action)\n        (cancel-timeout id)\n\n        (= :flush action)\n        (when-let [{:keys [action event]} (get @deferred-actions id)]\n          (cancel-timeout id)\n          (run-action action event))\n\n        :else\n        (throw (js/Error (str \":dispatch-debounce invalid action \" action)))))))\n\n(reg-fx :dispatch-debounce dispatch-debounce)\n"]}